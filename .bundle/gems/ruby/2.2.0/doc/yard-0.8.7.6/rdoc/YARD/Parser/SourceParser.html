<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class YARD::Parser::SourceParser - yard-0.8.7.6 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-after_parse_file">::after_parse_file</a>
    
    <li ><a href="#method-c-after_parse_file_callbacks">::after_parse_file_callbacks</a>
    
    <li ><a href="#method-c-after_parse_list">::after_parse_list</a>
    
    <li ><a href="#method-c-after_parse_list_callbacks">::after_parse_list_callbacks</a>
    
    <li ><a href="#method-c-before_parse_file">::before_parse_file</a>
    
    <li ><a href="#method-c-before_parse_file_callbacks">::before_parse_file_callbacks</a>
    
    <li ><a href="#method-c-before_parse_list">::before_parse_list</a>
    
    <li ><a href="#method-c-before_parse_list_callbacks">::before_parse_list_callbacks</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-parse">::parse</a>
    
    <li ><a href="#method-c-parse_in_order">::parse_in_order</a>
    
    <li ><a href="#method-c-parse_string">::parse_string</a>
    
    <li ><a href="#method-c-parser_type-3D">::parser_type=</a>
    
    <li ><a href="#method-c-parser_type_extensions-3D">::parser_type_extensions=</a>
    
    <li ><a href="#method-c-parser_type_for_extension">::parser_type_for_extension</a>
    
    <li ><a href="#method-c-parser_types-3D">::parser_types=</a>
    
    <li ><a href="#method-c-register_parser_type">::register_parser_type</a>
    
    <li ><a href="#method-c-tokenize">::tokenize</a>
    
    <li ><a href="#method-c-validated_parser_type">::validated_parser_type</a>
    
    <li ><a href="#method-i-convert_encoding">#convert_encoding</a>
    
    <li ><a href="#method-i-parse">#parse</a>
    
    <li ><a href="#method-i-parser_class">#parser_class</a>
    
    <li ><a href="#method-i-parser_type-3D">#parser_type=</a>
    
    <li ><a href="#method-i-parser_type_for_filename">#parser_type_for_filename</a>
    
    <li ><a href="#method-i-post_process">#post_process</a>
    
    <li ><a href="#method-i-tokenize">#tokenize</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-YARD::Parser::SourceParser">
  <h1 id="class-YARD::Parser::SourceParser" class="class">
    class YARD::Parser::SourceParser
  </h1>

  <section class="description">
    
<p>Responsible for parsing a source file into the namespace. Parsing also
invokes handlers to process the parsed statements and generate any code
objects that may be recognized.</p>

<h2 id="class-YARD::Parser::SourceParser-label-Custom+Parsers">Custom Parsers<span><a href="#class-YARD::Parser::SourceParser-label-Custom+Parsers">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><a href="SourceParser.html">SourceParser</a> allows custom parsers to be
registered and called when a certain filetype is recognized. To register a
parser and hook it up to a set of file extensions, call
{register_parser_type}</p>

<p>@see <a
href="SourceParser.html#method-c-register_parser_type">::register_parser_type</a>
@see <a href="../Handlers/Base.html">Handlers::Base</a> @see <a
href="../CodeObjects/Base.html">CodeObjects::Base</a></p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="ENCODING_BYTE_ORDER_MARKS">ENCODING_BYTE_ORDER_MARKS
        
        <dd><p>Byte order marks for various encodings @since 0.7.0</p>
        
      
        <dt id="ENCODING_LINE">ENCODING_LINE
        
        <dd>
        
      
        <dt id="SHEBANG_LINE">SHEBANG_LINE
        
        <dd>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-c-parser_type" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parser_type</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [Symbol] the default parser type (defaults to :ruby)</p>
        
        </div>
      </div>
      
      <div id="attribute-c-parser_type_extensions" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parser_type_extensions</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [Hash] a list of registered parser type extensions @private @since
0.5.6</p>
        
        </div>
      </div>
      
      <div id="attribute-c-parser_types" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parser_types</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [Hash{Symbol=&gt;Object}] a list of registered parser types
@private @since 0.5.6</p>
        
        </div>
      </div>
      
      <div id="attribute-i-contents" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">contents</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [String] the contents of the file to be parsed @since 0.7.0</p>
        
        </div>
      </div>
      
      <div id="attribute-i-file" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">file</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>@return [String] the filename being parsed by the parser.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-globals" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">globals</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [OpenStruct] an open struct containing arbitrary global state</p>

<pre>shared between files and handlers.</pre>

<p>@since 0.7.0</p>
        
        </div>
      </div>
      
      <div id="attribute-i-parser_type" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parser_type</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>@return [Symbol] the parser type associated with the parser instance.</p>

<pre>This should be set by the {#initialize constructor}.</pre>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-after_parse_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">after_parse_file</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Registers a callback to be called after an individual file is parsed. The
block passed to this method will be called on subsequent parse calls.</p>

<p>To register a callback that is called after the entire list of files is
processed, see {after_parse_list}.</p>

<p>@example Printing the length of each file after it is parsed</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">after_parse_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{parser.file} is #{parser.contents.size} characters&quot;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&#39;lib   /*.rb&#39;</span>)
<span class="ruby-comment"># prints:</span>
<span class="ruby-string">&quot;lib/foo.rb is 1240 characters&quot;</span>
<span class="ruby-string">&quot;lib/foo_bar.rb is 248 characters&quot;</span>
</pre>

<p>@yield [parser] the yielded block is called once after each file</p>

<pre>that is parsed. This might happen many times for a single codebase.</pre>

<p>@yieldparam [SourceParser] parser the parser object that parsed</p>

<pre>the file.</pre>

<p>@yieldreturn [void] the return value for the block is ignored. @return
[Proc] the yielded block @see <a
href="SourceParser.html#method-c-before_parse_file">::before_parse_file</a>
@see <a
href="SourceParser.html#method-c-after_parse_list">::after_parse_list</a>
@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="after_parse_file-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 321</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_parse_file</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">after_parse_file_callbacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-after_parse_file_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">after_parse_file_callbacks</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [Array&lt;Proc&gt;] the list of callbacks to be called after</p>

<pre>parsing a file. Should only be used for testing.</pre>

<p>@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="after_parse_file_callbacks-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 349</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_parse_file_callbacks</span>
  <span class="ruby-ivar">@after_parse_file_callbacks</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-after_parse_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">after_parse_list</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Registers a callback to be called after a list of files is parsed via
{parse}. The block passed to this method will be called on subsequent parse
calls.</p>

<p>@example Printing results after parsing occurs</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">after_parse_list</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Finished parsing!&quot;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>
<span class="ruby-comment"># Prints &quot;Finished parsing!&quot; after parsing files</span>
</pre>

<p>@yield [files, globals] the yielded block is called once before</p>

<pre class="ruby"><span class="ruby-identifier">parsing</span> <span class="ruby-identifier">all</span> <span class="ruby-identifier">files</span>
</pre>

<p>@yieldparam [Array&lt;String&gt;] files the list of files that will be
parsed. @yieldparam [OpenStruct] globals a global structure to store
arbitrary</p>

<pre>state for post processing (see {Handlers::Processor#globals})</pre>

<p>@yieldreturn [void] the return value for the block is ignored. @return
[Proc] the yielded block @see <a
href="SourceParser.html#method-c-before_parse_list">::before_parse_list</a>
@see <a
href="SourceParser.html#method-c-before_parse_file">::before_parse_file</a>
@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="after_parse_list-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_parse_list</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">after_parse_list_callbacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-after_parse_list_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">after_parse_list_callbacks</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [Array&lt;Proc&gt;] the list of callbacks to be called after</p>

<pre>parsing a list of files. Should only be used for testing.</pre>

<p>@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="after_parse_list_callbacks-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 335</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_parse_list_callbacks</span>
  <span class="ruby-ivar">@after_parse_list_callbacks</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-before_parse_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">before_parse_file</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Registers a callback to be called before an individual file is parsed. The
block passed to this method will be called on subsequent parse calls.</p>

<p>To register a callback that is called before the entire list of files is
processed, see {before_parse_list}.</p>

<p>@example Installing a simple callback</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">before_parse_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;I&#39;m parsing #{parser.file}&quot;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&#39;lib   /*.rb&#39;</span>)
<span class="ruby-comment"># prints:</span>
<span class="ruby-string">&quot;I&#39;m parsing lib/foo.rb&quot;</span>
<span class="ruby-string">&quot;I&#39;m parsing lib/foo_bar.rb&quot;</span>
<span class="ruby-string">&quot;I&#39;m parsing lib/last_file.rb&quot;</span>
</pre>

<p>@example Cancel parsing of any test_*.rb files</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">before_parse_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span><span class="ruby-operator">|</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^test_.+\.rb$/</span>
<span class="ruby-keyword">end</span>
</pre>

<p>@yield [parser] the yielded block is called once before each</p>

<pre>file that is parsed. This might happen many times for a single
codebase.</pre>

<p>@yieldparam [SourceParser] parser the parser object that will {#parse}</p>

<pre>the file.</pre>

<p>@yieldreturn [Boolean] if the block returns <code>false</code>, parsing for</p>

<pre>the file is cancelled.</pre>

<p>@return [Proc] the yielded block @see <a
href="SourceParser.html#method-c-after_parse_file">::after_parse_file</a>
@see <a
href="SourceParser.html#method-c-before_parse_list">::before_parse_list</a>
@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="before_parse_file-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 292</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">before_parse_file</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">before_parse_file_callbacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-before_parse_file_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">before_parse_file_callbacks</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [Array&lt;Proc&gt;] the list of callbacks to be called before</p>

<pre>parsing a file. Should only be used for testing.</pre>

<p>@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="before_parse_file_callbacks-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 342</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">before_parse_file_callbacks</span>
  <span class="ruby-ivar">@before_parse_file_callbacks</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-before_parse_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">before_parse_list</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Registers a callback to be called before a list of files is parsed via
{parse}. The block passed to this method will be called on subsequent parse
calls.</p>

<p>@example Installing a simple callback</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">before_parse_list</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">files</span>, <span class="ruby-identifier">globals</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Starting to parse...&quot;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&#39;lib   /*.rb&#39;</span>)
<span class="ruby-comment"># prints &quot;Starting to parse...&quot;</span>
</pre>

<p>@example Setting global state</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">before_parse_list</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">files</span>, <span class="ruby-identifier">globals</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">globals</span>.<span class="ruby-identifier">method_count</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">after_parse_list</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">files</span>, <span class="ruby-identifier">globals</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Found #{globals.method_count} methods&quot;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">class</span> <span class="ruby-constant">MyCountHandler</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Handlers</span><span class="ruby-operator">::</span><span class="ruby-constant">Ruby</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">handles</span> :<span class="ruby-keyword">def</span>, :<span class="ruby-identifier">defs</span>
  <span class="ruby-identifier">process</span> { <span class="ruby-identifier">globals</span>.<span class="ruby-identifier">method_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> }
<span class="ruby-keyword">end</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>
<span class="ruby-comment"># Prints: &quot;Found 37 methods&quot;</span>
</pre>

<p>@example Using a global callback to cancel parsing</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">before_parse_list</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">files</span>, <span class="ruby-identifier">globals</span><span class="ruby-operator">|</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;foo.rb&#39;</span>)
<span class="ruby-keyword">end</span>

<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>([<span class="ruby-string">&#39;foo.rb&#39;</span>, <span class="ruby-string">&#39;bar.rb&#39;</span>]) <span class="ruby-comment"># callback cancels this method</span>
<span class="ruby-constant">YARD</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&#39;bar.rb&#39;</span>) <span class="ruby-comment"># parses normally</span>
</pre>

<p>@yield [files, globals] the yielded block is called once before</p>

<pre class="ruby"><span class="ruby-identifier">parsing</span> <span class="ruby-identifier">all</span> <span class="ruby-identifier">files</span>
</pre>

<p>@yieldparam [Array&lt;String&gt;] files the list of files that will be
parsed. @yieldparam [OpenStruct] globals a global structure to store
arbitrary</p>

<pre>state for post processing (see {Handlers::Processor#globals})</pre>

<p>@yieldreturn [Boolean] if the block returns <code>false</code>, parsing is</p>

<pre>cancelled.</pre>

<p>@return [Proc] the yielded block @see <a
href="SourceParser.html#method-c-after_parse_list">::after_parse_list</a>
@see <a
href="SourceParser.html#method-c-before_parse_file">::before_parse_file</a>
@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="before_parse_list-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">before_parse_list</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">before_parse_list_callbacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-before_parse_list_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">before_parse_list_callbacks</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [Array&lt;Proc&gt;] the list of callbacks to be called before</p>

<pre>parsing a list of files. Should only be used for testing.</pre>

<p>@since 0.7.0</p>
          
          

          
          <div class="method-source-code" id="before_parse_list_callbacks-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 328</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">before_parse_list_callbacks</span>
  <span class="ruby-ivar">@before_parse_list_callbacks</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(parser_type = SourceParser.parser_type, globals1 = nil, globals2 = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@overload initialize(parser_type = <a
href="SourceParser.html#attribute-c-parser_type">::parser_type</a>, globals
= nil)</p>

<pre>Creates a new parser object for code parsing with a specific parser type.

@param [Symbol] parser_type the parser type to use
@param [OpenStruct] globals global state to be re-used across separate source files</pre>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 403</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">parser_type</span> = <span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">parser_type</span>, <span class="ruby-identifier">globals1</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">globals2</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">globals</span> = [<span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">globals1</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">globals2</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">globals1</span>
  <span class="ruby-ivar">@file</span> = <span class="ruby-string">&#39;(stdin)&#39;</span>
  <span class="ruby-ivar">@globals</span> = <span class="ruby-identifier">globals</span> <span class="ruby-operator">||</span> <span class="ruby-constant">OpenStruct</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parser_type</span> = <span class="ruby-identifier">parser_type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parse" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse</span><span
            class="method-args">(paths = ["{lib,app}/**/*.rb", "ext/**/*.c"], excluded = [], level = log.level)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parses a path or set of paths</p>

<p>@param [String, <a href="../../Array.html">Array</a>&lt;String&gt;] paths a
path, glob, or list of paths to</p>

<pre class="ruby"><span class="ruby-identifier">parse</span>
</pre>

<p>@param [Array&lt;String, Regexp&gt;] excluded a list of excluded path
matchers @param [Fixnum] level the logger level to use during parsing. See</p>

<pre>{YARD::Logger}</pre>

<p>@return [void]</p>
          
          

          
          <div class="method-source-code" id="parse-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 93</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse</span>(<span class="ruby-identifier">paths</span> = [<span class="ruby-string">&quot;{lib,app}/**/*.rb&quot;</span>, <span class="ruby-string">&quot;ext/**/*.c&quot;</span>], <span class="ruby-identifier">excluded</span> = [], <span class="ruby-identifier">level</span> = <span class="ruby-identifier">log</span>.<span class="ruby-identifier">level</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;Parsing #{paths.inspect} with `#{parser_type}` parser&quot;</span>)
  <span class="ruby-identifier">excluded</span> = <span class="ruby-identifier">excluded</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">path</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>; <span class="ruby-identifier">path</span>
    <span class="ruby-keyword">else</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-constant">Regexp</span><span class="ruby-operator">::</span><span class="ruby-constant">IGNORECASE</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">files</span> = [<span class="ruby-identifier">paths</span>].<span class="ruby-identifier">flatten</span>.
    <span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">p</span>) <span class="ruby-operator">?</span> <span class="ruby-node">&quot;#{p}/**/*.{rb,c}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">p</span> }.
    <span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;*&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">Dir</span>[<span class="ruby-identifier">p</span>].<span class="ruby-identifier">sort_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">length</span> } <span class="ruby-operator">:</span> <span class="ruby-identifier">p</span> }.<span class="ruby-identifier">flatten</span>.
    <span class="ruby-identifier">reject</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">p</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">excluded</span>.<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">re</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">re</span> } }

  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">enter_level</span>(<span class="ruby-identifier">level</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">parse_in_order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">files</span>.<span class="ruby-identifier">uniq</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parse_string" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_string</span><span
            class="method-args">(content, ptype = parser_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parses a string <code>content</code></p>

<p>@param [String] content the block of code to parse @param [Symbol] ptype
the parser type to use. See {parser_type}. @return the parser object that
was used to parse <code>content</code></p>
          
          

          
          <div class="method-source-code" id="parse_string-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_string</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">ptype</span> = <span class="ruby-identifier">parser_type</span>)
  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">ptype</span>).<span class="ruby-identifier">parse</span>(<span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">content</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parser_type-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_type=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parser_type-3D-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_type=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-ivar">@parser_type</span> = <span class="ruby-identifier">validated_parser_type</span>(<span class="ruby-identifier">value</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parser_type_extensions-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_type_extensions=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parser_type_extensions-3D-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_type_extensions=</span>(<span class="ruby-identifier">value</span>) <span class="ruby-identifier">@@parser_type_extensions</span> = <span class="ruby-identifier">value</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parser_type_for_extension" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_type_for_extension</span><span
            class="method-args">(extension)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Finds a parser type that is registered for the extension. If no type is
found, the default <a href="Ruby.html">Ruby</a> type is returned.</p>

<p>@return [Symbol] the parser type to be used for the extension @since 0.5.6</p>
          
          

          
          <div class="method-source-code" id="parser_type_for_extension-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_type_for_extension</span>(<span class="ruby-identifier">extension</span>)
  <span class="ruby-identifier">type</span> = <span class="ruby-identifier">parser_type_extensions</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span>, <span class="ruby-identifier">exts</span><span class="ruby-operator">|</span>
    [<span class="ruby-identifier">exts</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ext</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">extension</span> }
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">validated_parser_type</span>(<span class="ruby-identifier">type</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-value">:ruby</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-parser_types-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_types=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parser_types-3D-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_types=</span>(<span class="ruby-identifier">value</span>) <span class="ruby-identifier">@@parser_types</span> = <span class="ruby-identifier">value</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-register_parser_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">register_parser_type</span><span
            class="method-args">(type, parser_klass, extensions = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Registers a new parser type.</p>

<p>@example Registering a parser for “java” files</p>

<pre class="ruby"><span class="ruby-constant">SourceParser</span>.<span class="ruby-identifier">register_parser_type</span> :<span class="ruby-identifier">java</span>, <span class="ruby-constant">JavaParser</span>, <span class="ruby-string">&#39;java&#39;</span>
</pre>

<p>@param [Symbol] type a symbolic name for the parser type @param [Base]
parser_klass a class that implements parsing and tokenization @param
[Array&lt;String&gt;, <a href="../../String.html">String</a>, Regexp]
extensions a list of extensions or a</p>

<pre class="ruby"><span class="ruby-identifier">regex</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">match</span> <span class="ruby-identifier">against</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">file</span> <span class="ruby-identifier">extension</span>
</pre>

<p>@return [void] @see <a href="Base.html">Parser::Base</a></p>
          
          

          
          <div class="method-source-code" id="register_parser_type-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">register_parser_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">parser_klass</span>, <span class="ruby-identifier">extensions</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-constant">Base</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">parser_klass</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;expecting parser_klass to be a subclass of YARD::Parser::Base&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">parser_type_extensions</span>[<span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">extensions</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">extensions</span>
  <span class="ruby-identifier">parser_types</span>[<span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">parser_klass</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-tokenize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tokenize</span><span
            class="method-args">(content, ptype = parser_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tokenizes but does not parse the block of code</p>

<p>@param [String] content the block of code to tokenize @param [Symbol] ptype
the parser type to use. See {parser_type}. @return [Array] a list of tokens</p>
          
          

          
          <div class="method-source-code" id="tokenize-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 125</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tokenize</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">ptype</span> = <span class="ruby-identifier">parser_type</span>)
  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">ptype</span>).<span class="ruby-identifier">tokenize</span>(<span class="ruby-identifier">content</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-validated_parser_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validated_parser_type</span><span
            class="method-args">(type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the validated parser type. Basically, enforces that :ruby type is
never set if the Ripper library is not available</p>

<p>@param [Symbol] type the parser type to set @return [Symbol] the validated
parser type @private</p>
          
          

          
          <div class="method-source-code" id="validated_parser_type-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 181</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validated_parser_type</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Ripper</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:ruby</span> <span class="ruby-operator">?</span> <span class="ruby-value">:ruby18</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Class Methods</h3>
       </header>

    
      <div id="method-c-parse_in_order" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_in_order</span><span
            class="method-args">(*files)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parses a list of files in a queue.</p>

<p>@param [Array&lt;String&gt;] files a list of files to queue for parsing
@return [void]</p>
          
          

          
          <div class="method-source-code" id="parse_in_order-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 361</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_in_order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">files</span>)
  <span class="ruby-identifier">global_state</span> = <span class="ruby-constant">OpenStruct</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">before_parse_list_callbacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cb</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">files</span>, <span class="ruby-identifier">global_state</span>) <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">OrderedParser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">global_state</span>, <span class="ruby-identifier">files</span>).<span class="ruby-identifier">parse</span>

  <span class="ruby-identifier">after_parse_list_callbacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cb</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">files</span>, <span class="ruby-identifier">global_state</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-parse" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse</span><span
            class="method-args">(content = __FILE__)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The main parser method. This should not be called directly. Instead, use
the class methods {parse} and {parse_string}.</p>

<p>@param [String, read, Object] content the source file to parse @return
[Object, nil] the parser object used to parse the source</p>
          
          

          
          <div class="method-source-code" id="parse-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 415</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse</span>(<span class="ruby-identifier">content</span> = <span class="ruby-keyword">__FILE__</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">content</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
    <span class="ruby-ivar">@file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">cleanpath</span>(<span class="ruby-identifier">content</span>)
    <span class="ruby-identifier">content</span> = <span class="ruby-identifier">convert_encoding</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read_binary</span>(<span class="ruby-identifier">file</span>))
    <span class="ruby-identifier">checksum</span> = <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">checksum_for</span>(<span class="ruby-identifier">content</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">checksums</span>[<span class="ruby-identifier">file</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">checksum</span>

    <span class="ruby-keyword">if</span> <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">checksums</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">info</span> <span class="ruby-node">&quot;File &#39;#{file}&#39; was modified, re-processing...&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">checksums</span>[<span class="ruby-ivar">@file</span>] = <span class="ruby-identifier">checksum</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parser_type</span> = <span class="ruby-identifier">parser_type_for_filename</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">read</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:read</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@contents</span> = <span class="ruby-identifier">content</span>
  <span class="ruby-ivar">@parser</span> = <span class="ruby-identifier">parser_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">file</span>)

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">before_parse_file_callbacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cb</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">return</span> <span class="ruby-ivar">@parser</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>) <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">parse</span>
  <span class="ruby-identifier">post_process</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">after_parse_file_callbacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cb</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@parser</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-constant">NotImplementedError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-node">&quot;Cannot parse `#{file}&#39;: #{e.message}&quot;</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">backtrace</span>(<span class="ruby-identifier">e</span>, <span class="ruby-value">:warn</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">ParserSyntaxError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>.<span class="ruby-identifier">capitalize</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">backtrace</span>(<span class="ruby-identifier">e</span>, <span class="ruby-value">:warn</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-tokenize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tokenize</span><span
            class="method-args">(content)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tokenizes but does not parse the block of code using the current
{#parser_type}</p>

<p>@param [String] content the block of code to tokenize @return [Array] a
list of tokens</p>
          
          

          
          <div class="method-source-code" id="tokenize-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 459</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tokenize</span>(<span class="ruby-identifier">content</span>)
  <span class="ruby-ivar">@parser</span> = <span class="ruby-identifier">parser_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">file</span>)
  <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">tokenize</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-convert_encoding" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_encoding</span><span
            class="method-args">(content)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Searches for encoding line and forces encoding @since 0.5.3</p>
          
          

          
          <div class="method-source-code" id="convert_encoding-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 468</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_encoding</span>(<span class="ruby-identifier">content</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">content</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">content</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">ENCODING_LINE</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-node">$1</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;binary&#39;</span>)
    <span class="ruby-constant">ENCODING_BYTE_ORDER_MARKS</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">encoding</span>, <span class="ruby-identifier">bom</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">bom</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;binary&#39;</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">content</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">bom</span>.<span class="ruby-identifier">size</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">bom</span>
        <span class="ruby-identifier">content</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-identifier">encoding</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">content</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;utf-8&#39;</span>) <span class="ruby-comment"># UTF-8 is default encoding</span>
    <span class="ruby-identifier">content</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_class</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@since 0.5.6</p>
          
          

          
          <div class="method-source-code" id="parser_class-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 510</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_class</span>
  <span class="ruby-identifier">klass</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">parser_types</span>[<span class="ruby-identifier">parser_type</span>]
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;invalid parser type &#39;#{parser_type}&#39; or unrecognized file&quot;</span>, <span class="ruby-identifier">caller</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">klass</span>
  <span class="ruby-identifier">klass</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_type-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_type=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parser_type-3D-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 495</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_type=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-ivar">@parser_type</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">validated_parser_type</span>(<span class="ruby-identifier">value</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_type_for_filename" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_type_for_filename</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Guesses the parser type to use depending on the file extension.</p>

<p>@param [String] filename the filename to use to guess the parser type
@return [Symbol] a parser type that matches the filename</p>
          
          

          
          <div class="method-source-code" id="parser_type_for_filename-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 503</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_type_for_filename</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">ext</span> = (<span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-identifier">filename</span>)[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&quot;&quot;</span>).<span class="ruby-identifier">downcase</span>
  <span class="ruby-identifier">type</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">parser_type_for_extension</span>(<span class="ruby-identifier">ext</span>)
  <span class="ruby-identifier">parser_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:ruby18</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:ruby</span> <span class="ruby-operator">?</span> <span class="ruby-value">:ruby18</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-post_process" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">post_process</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs a {Handlers::Processor} object to post process the parsed statements.
@return [void]</p>
          
          

          
          <div class="method-source-code" id="post_process-source">
            <pre><span class="ruby-comment"># File lib/yard/parser/source_parser.rb, line 488</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">post_process</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:enumerator</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">enumerator</span> = <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">enumerator</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-constant">Handlers</span><span class="ruby-operator">::</span><span class="ruby-constant">Processor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">process</span>(<span class="ruby-identifier">enumerator</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

